{% extends 'chat/base.html' %}
<!---->
{%block title%} Chat {%endblock%}
<!---->
{%block content%}
<div class="row">
  <div class="col-md-8">
    {% comment %} What chat room would you like to join?<br />
    <input
      id="room-name-input"
      type="text"
      size="40"
      placeholder="Room Name"
    /><br />
    {% endcomment %}
    <input id="room-name-submit" class="mt-3" type="button" value="Join" />
    {%for chat in chats%} {%for participant in chat.participants.all%}
    <!---->
    {%if participant != request.user%}
    <div class="card mt-3">
      <div class="card-body">
        <h5 class="card-title">{{participant}}</h5>
        <p class="card-text">
          <a href="{% url 'chat:room' chat.id %}" class="btn btn-primary mt-3"
            >Chat with {{ participant.username }}</a
          >
        </p>
      </div>
    </div>

    {%endif%} {%endfor%} {%endfor%}
  </div>
  <div class="col-md-4">
    <!--title for contact-->
    <h3 class="text-center">Contacts</h3>
    <!--contact list-->
    <ul class="list-group">
      {%for contact in contacts%} {%for friend in contact.friends.all%}
      <li class="list-group-item">{{friend.user.username}}</li>
      {%endfor%} {%endfor%}
    </ul>
  </div>
</div>

<script>
  document.querySelector("#room-name-input").focus();
  document.querySelector("#room-name-input").onkeyup = function (e) {
    if (e.keyCode === 13) {
      // enter, return
      document.querySelector("#room-name-submit").click();
    }
  };

  document.querySelector("#room-name-submit").onclick = function (e) {
    var roomName = document.querySelector("#room-name-input").value;
    window.location.pathname = "/api/v1/" + roomName + "/";
  };
</script>
{%endblock%}
